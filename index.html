<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SUPERHITZ by Akin S. Sokpah</title>
  <style>
    body { font-family: Poppins, sans-serif; background: linear-gradient(135deg,#001f3f,#daa520); color:#fff; text-align:center; }
    h1 { margin-top: 50px; font-size: 2.5em; }
    button { background:#daa520; border:none; padding:10px 20px; border-radius:8px; color:#001f3f; font-weight:bold; cursor:pointer; }
    #output { margin-top:20px; white-space:pre-line; }
    audio { margin-top:20px; width:80%; }
  </style>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getAuth, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
    import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-storage.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAGvgWqTdd0tt72NZAc6XQVM1GOj6FgThs",
      authDomain: "superhitz-app.firebaseapp.com",
      projectId: "superhitz-app",
      storageBucket: "superhitz-app.firebasestorage.app",
      messagingSenderId: "872258546441",
      appId: "1:872258546441:web:fe82ded48bb326a649c1d8"
    };
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const provider = new GoogleAuthProvider();

    window.login = () => {
      signInWithPopup(auth, provider)
        .then(result => alert(`Welcome ${result.user.displayName}`))
        .catch(e => alert(e.message));
    };

    async function chatGPT() {
      const prompt = document.getElementById("prompt").value;
      const res = await fetch("/api/gptChat", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ prompt })
      });
      const data = await res.json();
      document.getElementById("output").innerText = data.reply;
    }

    async function genMusic() {
      const prompt = document.getElementById("prompt").value;
      const res = await fetch("/music/musicGen", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ prompt })
      });
      const blob = await res.blob();
      const url = URL.createObjectURL(blob);
      const audio = document.getElementById("audio");
      audio.src = url;
      audio.play();
    }

    window.chatGPT = chatGPT;
    window.genMusic = genMusic;
  </script>
</head>
<body>
  <h1>ðŸŽµ SUPERHITZ by Akin S. Sokpah</h1>
  <p>AI Music + Lyrics Studio</p>
  <button onclick="login()">Sign In with Google</button><br><br>
  <textarea id="prompt" rows="4" cols="50" placeholder="Describe your song or ask GPT..."></textarea><br>
  <button onclick="chatGPT()">ðŸ’¬ Chat / Lyrics</button>
  <button onclick="genMusic()">ðŸŽ¶ Generate Music</button>
  <div id="output"></div>
  <audio id="audio" controls></audio>
</body>
</html>
